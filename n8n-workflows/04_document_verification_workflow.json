{
  "name": "ğŸ“ ì„œë¥˜ ê²€ì¦ ë° OCR ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš°",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "documents/upload",
        "options": {
          "rawBody": true
        }
      },
      "id": "webhook-upload",
      "name": "ğŸ“¥ ì„œë¥˜ ì—…ë¡œë“œ",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [0, 300],
      "webhookId": "document-upload-webhook"
    },
    {
      "parameters": {
        "jsCode": "// ì—…ë¡œë“œ ë°ì´í„° ê²€ì¦\nconst body = $input.first().json.body;\nconst errors = [];\n\nif (!body.claimId) errors.push('claimId í•„ìˆ˜');\nif (!body.documentType) errors.push('documentType í•„ìˆ˜');\nif (!body.fileData) errors.push('fileData (Base64) í•„ìˆ˜');\n\nconst validTypes = [\n  'ADMISSION_CERTIFICATE',    // ì…ì›í™•ì¸ì„œ\n  'DISCHARGE_CERTIFICATE',    // í‡´ì›í™•ì¸ì„œ\n  'DIAGNOSIS_CERTIFICATE',    // ì§„ë‹¨ì„œ\n  'MEDICAL_RECEIPT',          // ì§„ë£Œë¹„ ì˜ìˆ˜ì¦\n  'PRESCRIPTION',             // ì²˜ë°©ì „\n  'SURGERY_RECORD',           // ìˆ˜ìˆ ê¸°ë¡ì§€\n  'OUTPATIENT_RECORD',        // í†µì›í™•ì¸ì„œ\n  'MEDICAL_RECORD',           // ì§„ë£Œê¸°ë¡ë¶€\n  'OTHER'                     // ê¸°íƒ€\n];\n\nif (body.documentType && !validTypes.includes(body.documentType)) {\n  errors.push(`ìœ íš¨í•˜ì§€ ì•Šì€ ì„œë¥˜ìœ í˜•: ${body.documentType}`);\n}\n\nreturn {\n  isValid: errors.length === 0,\n  errors: errors,\n  claimId: body.claimId,\n  documentType: body.documentType,\n  fileName: body.fileName || 'document.pdf',\n  fileData: body.fileData,\n  uploadedAt: new Date().toISOString()\n};"
      },
      "id": "validate-upload",
      "name": "âœ… ì—…ë¡œë“œ ê²€ì¦",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [220, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "valid-check",
              "leftValue": "={{ $json.isValid }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "if-valid",
      "name": "ğŸ”€ ìœ íš¨ì„± ì²´í¬",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [440, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=http://insurtech-api:3000/api/claims/{{ $json.claimId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "id": "get-claim",
      "name": "ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [660, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=http://insurtech-api:3000/api/documents/checklist/{{ $('âœ… ì—…ë¡œë“œ ê²€ì¦').item.json.claimId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "id": "get-checklist",
      "name": "ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"gpt-4o\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"ë‹¹ì‹ ì€ ë³´í—˜ ì„œë¥˜ ê²€ì¦ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì œê³µëœ ì„œë¥˜ ì´ë¯¸ì§€ì—ì„œ í•µì‹¬ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ê³  ê²€ì¦í•˜ì„¸ìš”.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"ë‹¤ìŒ {{ $('âœ… ì—…ë¡œë“œ ê²€ì¦').item.json.documentType }} ì„œë¥˜ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.\\n\\nê²€ì¦ ì²­êµ¬ ì •ë³´:\\n- ì²­êµ¬ë²ˆí˜¸: {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.claim_number }}\\n- ê³ ê°ëª…: {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.customer_name }}\\n- ì§„ë‹¨ëª…: {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.diagnosis_name }}\\n- ë³‘ì›ëª…: {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.hospital_name }}\\n- ì¹˜ë£Œê¸°ê°„: {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.treatment_start_date }} ~ {{ $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data.treatment_end_date }}\\n\\nì„œë¥˜ì—ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ê³  ì²­êµ¬ ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•´ì£¼ì„¸ìš”:\\n1. í™˜ìëª…\\n2. ë³‘ì›ëª…\\n3. ì§„ë‹¨ëª…/ì§„ë‹¨ì½”ë“œ\\n4. ì…ì›/ì¹˜ë£Œ ê¸°ê°„\\n5. ê¸ˆì•¡ (ì˜ìˆ˜ì¦ì¸ ê²½ìš°)\\n\\në‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”:\\n{\\n  \\\"extractedData\\\": {\\n    \\\"patientName\\\": \\\"ì¶”ì¶œëœ í™˜ìëª…\\\",\\n    \\\"hospitalName\\\": \\\"ì¶”ì¶œëœ ë³‘ì›ëª…\\\",\\n    \\\"diagnosis\\\": \\\"ì¶”ì¶œëœ ì§„ë‹¨ëª…\\\",\\n    \\\"diagnosisCode\\\": \\\"ì¶”ì¶œëœ ì§„ë‹¨ì½”ë“œ\\\",\\n    \\\"treatmentPeriod\\\": \\\"ì¶”ì¶œëœ ì¹˜ë£Œê¸°ê°„\\\",\\n    \\\"amount\\\": ì¶”ì¶œëœ ê¸ˆì•¡ (ìˆ«ì, ì—†ìœ¼ë©´ null)\\n  },\\n  \\\"verification\\\": {\\n    \\\"patientNameMatch\\\": true/false,\\n    \\\"hospitalMatch\\\": true/false,\\n    \\\"diagnosisMatch\\\": true/false,\\n    \\\"periodMatch\\\": true/false,\\n    \\\"overallValid\\\": true/false\\n  },\\n  \\\"issues\\\": [\\\"ë°œê²¬ëœ ë¬¸ì œì  ëª©ë¡\\\"],\\n  \\\"confidence\\\": 0.0-1.0,\\n  \\\"documentQuality\\\": \\\"GOOD/FAIR/POOR\\\"\\n}\"\n        },\n        {\n          \"type\": \"image_url\",\n          \"image_url\": {\n            \"url\": \"data:image/jpeg;base64,{{ $('âœ… ì—…ë¡œë“œ ê²€ì¦').item.json.fileData }}\"\n          }\n        }\n      ]\n    }\n  ],\n  \"max_tokens\": 2000\n}",
        "options": {}
      },
      "id": "ocr-analysis",
      "name": "ğŸ” GPT-4o OCR ë¶„ì„",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1100, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "openai-api",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// OCR ê²°ê³¼ íŒŒì‹± ë° ê²€ì¦\nconst ocrResponse = $input.first().json.choices?.[0]?.message?.content;\nconst uploadData = $('âœ… ì—…ë¡œë“œ ê²€ì¦').item.json;\nconst claimData = $('ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ').item.json.data;\nconst checklist = $('ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ').item.json.data || [];\n\nlet ocrResult;\ntry {\n  ocrResult = JSON.parse(ocrResponse.replace(/```json\\n?|```/g, ''));\n} catch (e) {\n  ocrResult = {\n    extractedData: {},\n    verification: { overallValid: false },\n    issues: ['OCR ê²°ê³¼ íŒŒì‹± ì‹¤íŒ¨'],\n    confidence: 0,\n    documentQuality: 'POOR'\n  };\n}\n\n// ê²€ì¦ ìƒíƒœ ê²°ì •\nlet verificationStatus = 'PENDING';\nlet verificationResult = 'NEEDS_REVIEW';\n\nif (ocrResult.verification?.overallValid && ocrResult.confidence >= 0.8) {\n  verificationStatus = 'VERIFIED';\n  verificationResult = 'APPROVED';\n} else if (ocrResult.confidence < 0.5 || ocrResult.issues?.length > 2) {\n  verificationStatus = 'REJECTED';\n  verificationResult = 'REJECTED';\n} else {\n  verificationStatus = 'NEEDS_REVIEW';\n  verificationResult = 'NEEDS_MANUAL_REVIEW';\n}\n\n// ì²´í¬ë¦¬ìŠ¤íŠ¸ì—ì„œ í•´ë‹¹ ì„œë¥˜ í•­ëª© ì°¾ê¸°\nconst checklistItem = checklist.find(c => c.document_type === uploadData.documentType);\n\nreturn {\n  claimId: uploadData.claimId,\n  documentType: uploadData.documentType,\n  fileName: uploadData.fileName,\n  claim: claimData,\n  ocrResult: ocrResult,\n  verificationStatus: verificationStatus,\n  verificationResult: verificationResult,\n  checklistItemId: checklistItem?.id,\n  confidence: ocrResult.confidence,\n  issues: ocrResult.issues || [],\n  processedAt: new Date().toISOString()\n};"
      },
      "id": "parse-ocr",
      "name": "ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1320, 200]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.verificationStatus }}",
                    "rightValue": "VERIFIED",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "VERIFIED"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.verificationStatus }}",
                    "rightValue": "REJECTED",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "REJECTED"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.verificationStatus }}",
                    "rightValue": "NEEDS_REVIEW",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "NEEDS_REVIEW"
            }
          ]
        },
        "options": {}
      },
      "id": "switch-status",
      "name": "ğŸ”€ ê²€ì¦ ê²°ê³¼ ë¶„ê¸°",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [1540, 200]
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=http://insurtech-api:3000/api/documents/verify/{{ $json.checklistItemId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"status\": \"VERIFIED\",\n  \"verifiedBy\": \"AI_OCR\",\n  \"extractedData\": {{ JSON.stringify($json.ocrResult.extractedData) }},\n  \"confidence\": {{ $json.confidence }},\n  \"verifiedAt\": \"{{ $json.processedAt }}\"\n}",
        "options": {}
      },
      "id": "update-verified",
      "name": "âœ… ê²€ì¦ ì™„ë£Œ ì²˜ë¦¬",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1760, 100],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=http://insurtech-api:3000/api/documents/verify/{{ $json.checklistItemId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"status\": \"REJECTED\",\n  \"verifiedBy\": \"AI_OCR\",\n  \"rejectionReason\": \"{{ $json.issues.join(', ') }}\",\n  \"extractedData\": {{ JSON.stringify($json.ocrResult.extractedData) }},\n  \"confidence\": {{ $json.confidence }},\n  \"verifiedAt\": \"{{ $json.processedAt }}\"\n}",
        "options": {}
      },
      "id": "update-rejected",
      "name": "âŒ ê²€ì¦ ì‹¤íŒ¨ ì²˜ë¦¬",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1760, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=http://insurtech-api:3000/api/documents/verify/{{ $json.checklistItemId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"status\": \"NEEDS_REVIEW\",\n  \"verifiedBy\": \"AI_OCR\",\n  \"reviewNote\": \"AI ê²€ì¦ ë¶ˆí™•ì‹¤ - ìˆ˜ë™ ê²€í†  í•„ìš”\",\n  \"issues\": {{ JSON.stringify($json.issues) }},\n  \"extractedData\": {{ JSON.stringify($json.ocrResult.extractedData) }},\n  \"confidence\": {{ $json.confidence }},\n  \"verifiedAt\": \"{{ $json.processedAt }}\"\n}",
        "options": {}
      },
      "id": "update-needs-review",
      "name": "âš ï¸ ìˆ˜ë™ ê²€í†  ìš”ì²­",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1760, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=http://insurtech-api:3000/api/documents/checklist/{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "id": "check-all-docs",
      "name": "ğŸ“‹ ì „ì²´ ì„œë¥˜ í™•ì¸",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1980, 100],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ëª¨ë“  ì„œë¥˜ ì™„ë£Œ ì—¬ë¶€ í™•ì¸\nconst checklist = $input.first().json.data || [];\nconst claimData = $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claim;\n\nconst totalDocs = checklist.length;\nconst verifiedDocs = checklist.filter(c => c.status === 'VERIFIED').length;\nconst rejectedDocs = checklist.filter(c => c.status === 'REJECTED').length;\nconst pendingDocs = checklist.filter(c => c.status === 'PENDING' || c.status === 'NEEDS_REVIEW').length;\n\nconst allVerified = verifiedDocs === totalDocs && totalDocs > 0;\nconst hasRejected = rejectedDocs > 0;\n\nreturn {\n  claimId: $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId,\n  claim: claimData,\n  totalDocs: totalDocs,\n  verifiedDocs: verifiedDocs,\n  rejectedDocs: rejectedDocs,\n  pendingDocs: pendingDocs,\n  allVerified: allVerified,\n  hasRejected: hasRejected,\n  checklist: checklist,\n  canProceed: allVerified && !hasRejected\n};"
      },
      "id": "check-completion",
      "name": "ğŸ” ì™„ë£Œ ì—¬ë¶€ í™•ì¸",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2200, 100]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "all-verified",
              "leftValue": "={{ $json.allVerified }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "if-all-verified",
      "name": "ğŸ”€ ì „ì²´ ê²€ì¦ ì™„ë£Œ?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2420, 100]
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=http://insurtech-api:3000/api/claims/{{ $json.claimId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"document_status\": \"COMPLETE\",\n  \"document_verified_at\": \"{{ new Date().toISOString() }}\"\n}",
        "options": {}
      },
      "id": "update-claim-complete",
      "name": "ğŸ“„ ì²­êµ¬ ì„œë¥˜ì™„ë£Œ ì²˜ë¦¬",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2640, 0],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    },
    {
      "parameters": {
        "channel": "#insurance-claims",
        "text": "=âœ… *ì„œë¥˜ ê²€ì¦ ì™„ë£Œ*\n\nì²­êµ¬ë²ˆí˜¸: {{ $json.claim.claim_number }}\nê³ ê°ëª…: {{ $json.claim.customer_name }}\n\nğŸ“ ì´ {{ $json.totalDocs }}ê±´ ì„œë¥˜ ëª¨ë‘ ê²€ì¦ ì™„ë£Œ\n\nì²­êµ¬ ì‹¬ì‚¬ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        "otherOptions": {}
      },
      "id": "slack-all-complete",
      "name": "ğŸ“± Slack (ì „ì²´ì™„ë£Œ)",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [2860, 0],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    },
    {
      "parameters": {
        "channel": "#insurance-claims",
        "text": "=âœ… *ì„œë¥˜ ê²€ì¦ ì„±ê³µ*\n\nì²­êµ¬ë²ˆí˜¸: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claim.claim_number }}\nì„œë¥˜ìœ í˜•: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\nì‹ ë¢°ë„: {{ ($('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.confidence * 100).toFixed(1) }}%\n\nì¶”ì¶œ ì •ë³´:\nâ€¢ í™˜ìëª…: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.ocrResult.extractedData.patientName }}\nâ€¢ ë³‘ì›ëª…: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.ocrResult.extractedData.hospitalName }}\nâ€¢ ì§„ë‹¨ëª…: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.ocrResult.extractedData.diagnosis }}",
        "otherOptions": {}
      },
      "id": "slack-verified",
      "name": "ğŸ“± Slack (ê²€ì¦ì„±ê³µ)",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1980, -100],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    },
    {
      "parameters": {
        "channel": "#insurance-claims",
        "text": "=âŒ *ì„œë¥˜ ê²€ì¦ ì‹¤íŒ¨*\n\nì²­êµ¬ë²ˆí˜¸: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claim.claim_number }}\nì„œë¥˜ìœ í˜•: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\n\në¬¸ì œì :\n{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.issues.map(i => 'â€¢ ' + i).join('\\n') }}\n\nì¬ì œì¶œì´ í•„ìš”í•©ë‹ˆë‹¤.",
        "otherOptions": {}
      },
      "id": "slack-rejected",
      "name": "ğŸ“± Slack (ê²€ì¦ì‹¤íŒ¨)",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1980, 200],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    },
    {
      "parameters": {
        "channel": "#insurance-claims",
        "text": "=âš ï¸ *ì„œë¥˜ ìˆ˜ë™ ê²€í†  í•„ìš”*\n\nì²­êµ¬ë²ˆí˜¸: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claim.claim_number }}\nì„œë¥˜ìœ í˜•: {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\nAI ì‹ ë¢°ë„: {{ ($('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.confidence * 100).toFixed(1) }}%\n\në¶ˆí™•ì‹¤ í•­ëª©:\n{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.issues.map(i => 'â€¢ ' + i).join('\\n') }}\n\në‹´ë‹¹ì í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        "otherOptions": {}
      },
      "id": "slack-needs-review",
      "name": "ğŸ“± Slack (ìˆ˜ë™ê²€í† )",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1980, 400],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"message\": \"ì„œë¥˜ê°€ ì„±ê³µì ìœ¼ë¡œ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.\",\n  \"data\": {\n    \"claimId\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId }},\n    \"documentType\": \"{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\",\n    \"status\": \"VERIFIED\",\n    \"confidence\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.confidence }},\n    \"extractedData\": {{ JSON.stringify($('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.ocrResult.extractedData) }}\n  }\n}",
        "options": {}
      },
      "id": "response-verified",
      "name": "ğŸ“¤ ì‘ë‹µ (ê²€ì¦ì„±ê³µ)",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [3080, 0]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": false,\n  \"message\": \"ì„œë¥˜ ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¬ì œì¶œì´ í•„ìš”í•©ë‹ˆë‹¤.\",\n  \"data\": {\n    \"claimId\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId }},\n    \"documentType\": \"{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\",\n    \"status\": \"REJECTED\",\n    \"issues\": {{ JSON.stringify($('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.issues) }}\n  }\n}",
        "options": {
          "responseCode": 400
        }
      },
      "id": "response-rejected",
      "name": "ğŸ“¤ ì‘ë‹µ (ê²€ì¦ì‹¤íŒ¨)",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [2200, 200]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"message\": \"ì„œë¥˜ê°€ ì œì¶œë˜ì—ˆìœ¼ë‚˜ ìˆ˜ë™ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.\",\n  \"data\": {\n    \"claimId\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId }},\n    \"documentType\": \"{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\",\n    \"status\": \"NEEDS_REVIEW\",\n    \"confidence\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.confidence }},\n    \"issues\": {{ JSON.stringify($('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.issues) }}\n  }\n}",
        "options": {}
      },
      "id": "response-needs-review",
      "name": "ğŸ“¤ ì‘ë‹µ (ìˆ˜ë™ê²€í† )",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [2200, 400]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": false,\n  \"message\": \"ì—…ë¡œë“œ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨\",\n  \"errors\": {{ JSON.stringify($json.errors) }}\n}",
        "options": {
          "responseCode": 400
        }
      },
      "id": "response-validation-error",
      "name": "âŒ ì‘ë‹µ (ê²€ì¦ì˜¤ë¥˜)",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [660, 400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://insurtech-api:3000/api/audit",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"entityType\": \"DOCUMENT\",\n  \"entityId\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.checklistItemId || 0 }},\n  \"action\": \"OCR_VERIFICATION\",\n  \"userId\": 1,\n  \"details\": {\n    \"claimId\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.claimId }},\n    \"documentType\": \"{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.documentType }}\",\n    \"status\": \"{{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.verificationStatus }}\",\n    \"confidence\": {{ $('ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±').item.json.confidence }},\n    \"source\": \"n8n-ocr-workflow\"\n  }\n}",
        "options": {}
      },
      "id": "audit-log",
      "name": "ğŸ“ ê°ì‚¬ ë¡œê·¸",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2640, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "jwt-token",
          "name": "JWT Token"
        }
      }
    }
  ],
  "connections": {
    "ğŸ“¥ ì„œë¥˜ ì—…ë¡œë“œ": {
      "main": [
        [
          {
            "node": "âœ… ì—…ë¡œë“œ ê²€ì¦",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… ì—…ë¡œë“œ ê²€ì¦": {
      "main": [
        [
          {
            "node": "ğŸ”€ ìœ íš¨ì„± ì²´í¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ ìœ íš¨ì„± ì²´í¬": {
      "main": [
        [
          {
            "node": "ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ ì‘ë‹µ (ê²€ì¦ì˜¤ë¥˜)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“„ ì²­êµ¬ ì •ë³´ ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "ğŸ” GPT-4o OCR ë¶„ì„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” GPT-4o OCR ë¶„ì„": {
      "main": [
        [
          {
            "node": "ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š OCR ê²°ê³¼ íŒŒì‹±": {
      "main": [
        [
          {
            "node": "ğŸ”€ ê²€ì¦ ê²°ê³¼ ë¶„ê¸°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ ê²€ì¦ ê²°ê³¼ ë¶„ê¸°": {
      "main": [
        [
          {
            "node": "âœ… ê²€ì¦ ì™„ë£Œ ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ ê²€ì¦ ì‹¤íŒ¨ ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âš ï¸ ìˆ˜ë™ ê²€í†  ìš”ì²­",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… ê²€ì¦ ì™„ë£Œ ì²˜ë¦¬": {
      "main": [
        [
          {
            "node": "ğŸ“± Slack (ê²€ì¦ì„±ê³µ)",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“‹ ì „ì²´ ì„œë¥˜ í™•ì¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âŒ ê²€ì¦ ì‹¤íŒ¨ ì²˜ë¦¬": {
      "main": [
        [
          {
            "node": "ğŸ“± Slack (ê²€ì¦ì‹¤íŒ¨)",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“ ê°ì‚¬ ë¡œê·¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš ï¸ ìˆ˜ë™ ê²€í†  ìš”ì²­": {
      "main": [
        [
          {
            "node": "ğŸ“± Slack (ìˆ˜ë™ê²€í† )",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“ ê°ì‚¬ ë¡œê·¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Slack (ê²€ì¦ì‹¤íŒ¨)": {
      "main": [
        [
          {
            "node": "ğŸ“¤ ì‘ë‹µ (ê²€ì¦ì‹¤íŒ¨)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Slack (ìˆ˜ë™ê²€í† )": {
      "main": [
        [
          {
            "node": "ğŸ“¤ ì‘ë‹µ (ìˆ˜ë™ê²€í† )",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ ì „ì²´ ì„œë¥˜ í™•ì¸": {
      "main": [
        [
          {
            "node": "ğŸ” ì™„ë£Œ ì—¬ë¶€ í™•ì¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” ì™„ë£Œ ì—¬ë¶€ í™•ì¸": {
      "main": [
        [
          {
            "node": "ğŸ”€ ì „ì²´ ê²€ì¦ ì™„ë£Œ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ ì „ì²´ ê²€ì¦ ì™„ë£Œ?": {
      "main": [
        [
          {
            "node": "ğŸ“„ ì²­êµ¬ ì„œë¥˜ì™„ë£Œ ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“¤ ì‘ë‹µ (ê²€ì¦ì„±ê³µ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“„ ì²­êµ¬ ì„œë¥˜ì™„ë£Œ ì²˜ë¦¬": {
      "main": [
        [
          {
            "node": "ğŸ“± Slack (ì „ì²´ì™„ë£Œ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Slack (ì „ì²´ì™„ë£Œ)": {
      "main": [
        [
          {
            "node": "ğŸ“¤ ì‘ë‹µ (ê²€ì¦ì„±ê³µ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "4",
  "meta": {
    "instanceId": "insurtech-n8n"
  },
  "tags": [
    {
      "name": "ì„œë¥˜",
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T00:00:00.000Z"
    },
    {
      "name": "OCR",
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}
